1. Display yearly income of  the Website.
SELECT TO_CHAR(DOP,'YYYY'),SUM(PRICE) AS INCOME FROM PURCHASE_C GROUP BY TO_CHAR(DOP,'YYYY');

2. Display Number of movies released in website every year :
SELECT TO_NUMBER(TO_CHAR(DOR,'YYYY')),COUNT(*) FROM RELEASES GROUP BY TO_NUMBER(TO_CHAR(DOR,'YYYY')) ;

3.Display Collection Of every Movie
SELECT COUNT(*) AS OVERVIEW, SUM(PRICE) AS COLLECTION FROM PURCHASE_C GROUP BY M_ID;

4.Display the name of more benefited customer
SELECT CNAME AS MOREBENEFITED FROM CUSTOMER WHERE CID IN( SELECT CID FROM PURCHASE_C GROUP BY CID HAVING COUNT(*)>=ALL(SELECT COUNT(*) FROM PURCHASE_C GROUP BY CID));

5.Display the name of best seller movie
SELECT MNAME AS MOSTSALED  FROM MOVIE WHERE M_ID IN (
SELECT M_ID FROM PURCHASE_C GROUP BY M_ID HAVING COUNT(*)>=ALL
(SELECT COUNT(*) FROM PURCHASE_C GROUP BY M_ID));

6.Display the Id of the admin who purchased more maximum movies
SELECT AID FROM PURCHASE GROUP BY AID HAVING COUNT(*)>=ALL( SELECT COUNT(*) FROM PURCHASE GROUP BY AID);

7.Display Name of the admin who released more movies in website.
SELECT ANAME FROM ADMIN WHERE AID IN(SELECT AID FROM PURCHASE GROUP BY AID HAVING COUNT(*)>=ALL( SELECT COUNT(*) FROM PURCHASE GROUP BY AID));

8.Display count of customers from each city
SELECT CITY,COUNT(*) FROM CUSTOMER GROUP BY CITY;

9.Display the age group which uses the website frequently
SELECT CAST (MONTHS_BETWEEN('31-OCT-2021',DOB)/12 AS INT) AS AGE,COUNT(*) AS COUNT_NUMBEER FROM CUSTOMER GROUP BY  CAST (MONTHS_BETWEEN('31-OCT-2021',DOB)/12 AS INT)
HAVING COUNT(*)>=ALL(SELECT COUNT(*) AS COUNT_AGE  FROM CUSTOMER GROUP BY  CAST (MONTHS_BETWEEN('31-OCT-2021',DOB)/12 AS INT));

10.Display the investment of each customer
SELECT CID, SUM(PRICE) AS INVESTMENT FROM PURCHASE_C GROUP BY CID;

11. Display the trending distributor ID
SELECT DID FROM DISTRIBUTOR WHERE MID IN(SELECT MID FROM PURCHASE WHERE PID IN(SELECT PID   FROM RELEASES  WHERE M_ID IN
(SELECT M_ID FROM PURCHASE_C GROUP BY M_ID HAVING COUNT(*)>=ALL
(SELECT COUNT(*) FROM PURCHASE_C GROUP BY M_ID))))

12. DISPLAY ALL THE CUSTOMER NAMES WHO PURCHASED AT LEAST ONE MOVIE:
SELECT CNAME AS CUSTOMER_NAME FROM CUSTOMER WHERE CID IN
(SELECT CID FROM PURCHASE_C GROUP BY CID HAVING COUNT(*)>0);

13. DISPLAY ALL THE CUSTOMER  NAMES:
SELECT CNAME FROM CUSTOMER;

14. DISPLAY CUSTOMERS WHO DID NOT PURCHASED A SINGLE MOVIE:
SELECT CNAME FROM CUSTOMER MINUS
SELECT CNAME FROM CUSTOMER WHERE CID IN(SELECT CID FROM PURCHASE_C GROUP BY CID HAVING COUNT(*)>0);

15. DISPLAY NUMBER OF HORROR MOVIES PURCHASE BY ADMIN:
SELECT COUNT(*) AS NO_OF_HORROR_MOVIES FROM PURCHASE WHERE MID IN(SELECT MID FROM HORROR);
SELECT COUNT(*) AS FROM NO _OF_COMEDY _MOVIES  PURCHASE WHERE MID IN(SELECT MID FROM COMEDY);
SELECT COUNT(*) AS NO _OF_FICTION _MOVIES FROM PURCHASE  WHERE MID IN(SELECT MID FROM FICTION);
